<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<title>Mines Spiel</title>
<style>
:root {
  --bg:#0f1720;
  --panel:#121820;
  --muted:#98a0aa;
  --accent:#00c853;
  --tile:#1b2230;
  --gem-size:110%;
  --bomb-size:80%;
  --lost-scale:0.75;
}

/* Body */
body { 
  margin:0; 
  display:flex; 
  flex-direction:row;
  min-height:100vh;
  padding-top:60px; 
  font-family:Inter, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  background:linear-gradient(180deg,var(--bg),#081019);
  box-sizing:border-box;
}

/* Header */
.header {
  width:100%;
  height:60px;
  position:fixed;
  top:0; left:0;
  background:linear-gradient(180deg,#121820,#0e1419);
  display:flex;
  align-items:center;
  justify-content:flex-start;
  padding-left:20px;
  box-shadow:0 2px 6px rgba(0,0,0,0.5);
  z-index:200;
}
.header img {
  max-height:80px;
  width:auto;
  object-fit:contain;
}

/* Sidebar */
.side { 
  width:310px;
  margin: 0 5px;
  background:linear-gradient(180deg,#1b2330,#121820); 
  padding:30px 25px; 
  display:flex; 
  flex-direction:column; 
  border-radius:16px;
  box-shadow: 0 8px 24px rgba(0,0,0,0.6);
  font-family: Inter, sans-serif;
}

/* Labels & Inputs */
.row label { 
  font-size:13px; 
  color:#a0a8b0; 
  margin-bottom:6px; 
  font-weight:500;
}

.row input { 
  padding:12px; 
  border-radius:10px; 
  border:none; 
  background:#1f2838; 
  color:#e6eef6; 
  font-size:15px; 
  width:100%; 
  box-sizing:border-box;
  box-shadow: inset 2px 2px 5px rgba(0,0,0,0.6), inset -2px -2px 5px rgba(255,255,255,0.05);
  transition:0.2s;
}
.row input:focus{
  outline:none;
  box-shadow: inset 2px 2px 5px rgba(0,0,0,0.6), inset -2px -2px 5px rgba(0,200,83,0.4);
}

/* Settings Zeile horizontal */
.row.settings {
  display: flex;
  gap: 5px; /* horizontaler Abstand zwischen Mines und Size */
  margin-top:5px;
}
.row.settings .col {
  flex:1;
  display:flex;
  flex-direction: column;
  gap:6px;
}

/* Buttons untereinander mit 5px Abstand */
.side button + button {
  margin-top:5px;
}

.big-btn { 
  width:100%;
  padding:14px; 
  border-radius:12px; 
  font-weight:700; 
  font-size:16px; 
  cursor:pointer; 
  border:none; 
  transition:0.3s;
}

.big-btn.green { 
  background: linear-gradient(180deg,#00c853,#009624); 
  color:#04210f;
}
.big-btn.green:hover{
  filter: brightness(1.15);
  box-shadow: 0 6px 16px rgba(0,0,0,0.6);
}

.big-btn.green.secondary { 
  font-size:18px; 
  padding:16px 0; 
}

.big-btn.disabled { 
  background:linear-gradient(180deg,#2a2f38,#1f232b); 
  color:#777; 
  cursor:not-allowed;
  box-shadow: inset 0 2px 6px rgba(0,0,0,0.5);
}

/* Grid Container */
.grid-container { 
  flex:1;                      
  display:flex;
  justify-content:flex-start;
  align-items:center;           
  padding:20px;
  box-sizing:border-box;
  min-height: calc(100vh - 60px);
  position:relative;
}

/* Grid quadratisch */
.grid { 
  display:grid;
  gap:8px;
  height:100%;       
  aspect-ratio:1/1;   
  width:auto;         
  margin-left:10px;  
}

/* Tiles */
.tile { 
  position:relative; 
  border-radius:10px; 
  background:var(--tile); 
  cursor:pointer; 
  display:flex; 
  justify-content:center; 
  align-items:center; 
  transition:0.1s;
}
.tile.clicked { background:black;}
.tile.revealed { background:#071015;}
.tile.black-bg { background:black;}
.gem, .bomb { position:absolute; background-size:contain; background-position:center; background-repeat:no-repeat; transition:0.5s;}
.gem { width:var(--gem-size); height:var(--gem-size); background-image: url('https://i.postimg.cc/Y06WsCVP/gem.png'); }
.bomb { width:var(--bomb-size); height:var(--bomb-size); background-image: url('https://i.postimg.cc/8cR60z3t/bomb.png'); }

.balance-display {
  position:absolute;
  top:10px;
  right:10px;
  font-size:26px;
  font-weight:bold;
  color:#ffffff;
  z-index:100;
}

/* Mobile */
@media (max-width: 768px) {
  body {
    flex-direction:column;
    padding-top:60px;
  }

  .grid-container {
    width:100%;
    height:auto;
    padding:10px;
    order:1; 
  }

  .side {
    width:100%;
    border-radius:0;
    min-height:auto;
    padding:20px;
    order:2; 
    margin:0;
  }

  .grid {
    width:100vw;
    height:100vw;
    gap:6px;
    margin-left:0; 
  }

  .balance-display {
    position:fixed;
    top:8px;
    right:10px;
    font-size:22px;
    z-index:100;
  }
}
</style>
</head>
<body>

<div class="header">
  <img src="https://i.postimg.cc/P5mRQW2M/logo.png" alt="Logo">
</div>

<div class="side">
  <div class="row">
    <label for="bet">Bet Amount</label>
    <input type="number" id="bet" value="10" min="0.01" step="0.01">
  </div>
  <div class="row settings">
    <div class="col">
      <label for="mines">Mines</label>
      <input type="number" id="mines" value="3" min="1" step="1">
    </div>
    <div class="col">
      <label for="gridSize">Size</label>
      <input type="number" id="gridSize" value="5" min="2" max="10" step="1">
    </div>
  </div>

  <!-- Buttons untereinander -->
  <button id="start" class="big-btn green">Start</button>
  <button id="randomBtn" class="big-btn disabled">Random Tile</button>
  <button id="cashoutBtn" class="big-btn green secondary" style="display:none">Cashout</button>
</div>

<div class="grid-container">
  <div class="balance-display" id="balanceTop">1000.00 €</div>
  <div class="grid" id="grid"></div>
</div>

<script>
const balanceTop=document.getElementById('balanceTop'),
      grid=document.getElementById('grid'),
      minesInp=document.getElementById('mines'),
      betInp=document.getElementById('bet'),
      gridInp=document.getElementById('gridSize'),
      startBtn=document.getElementById('start'),
      cashBtn=document.getElementById('cashoutBtn'),
      randomBtn=document.getElementById('randomBtn');

let bal=1000, bet=0, minesCount=3, mines=new Set(), revealed=new Set(), safe=0, inRound=false;
let gridSize=5, total=25;

function createGrid(size){
  grid.innerHTML='';
  grid.style.gridTemplateColumns=`repeat(${size},1fr)`;
  grid.style.gridTemplateRows=`repeat(${size},1fr)`;
  total=size*size;
  for(let i=0;i<total;i++){
    const t=document.createElement('div');
    t.className='tile';
    t.dataset.i=i;
    t.onclick=()=>reveal(i,t);
    grid.appendChild(t);
  }
}

function randomMines(k,total){
  const arr=[...Array(total).keys()];
  for(let i=arr.length-1;i>0;i--){
    const j=Math.floor(Math.random()*(i+1));
    [arr[i],arr[j]]=[arr[j],arr[i]];
  }
  return new Set(arr.slice(0,k));
}

function survival(k){
  if(k<=0) return 1;
  let p=1;
  for(let i=0;i<k;i++) p*=(total-minesCount-i)/(total-i);
  return p;
}

function fair(k){ const s=survival(k); return s>0?1/s:0; }

function updatePayout(){ 
  if(!inRound||bet<=0){ 
    cashBtn.textContent='Cashout';
    return;
  }
  const multiplier=fair(safe); 
  const amount=bet*multiplier; 
  cashBtn.textContent='Cashout: '+(isFinite(amount)?amount.toFixed(2)+' €':'0.00 €');
}

function startRound(){
  if(inRound) return;
  bet=parseFloat(betInp.value)||0;
  if(bet<=0||bet>bal){ alert('Ungültiger Einsatz'); return;}
  gridSize=parseInt(gridInp.value)||5;
  if(gridSize<2||gridSize>10){ alert('Ungültige Gridgröße'); return;}
  minesCount=parseInt(minesInp.value)||1;
  if(minesCount<1||minesCount>=gridSize*gridSize){ alert('Ungültige Mines'); return;}

  bal-=bet; balanceTop.textContent=bal.toFixed(2)+' €';
  inRound=true; safe=0; revealed=new Set(); mines=randomMines(minesCount,gridSize*gridSize);
  createGrid(gridSize);

  startBtn.style.display='none'; 
  cashBtn.style.display='inline-block';
  randomBtn.classList.remove('disabled');
  randomBtn.classList.add('green');
  minesInp.disabled=true; betInp.disabled=true; gridInp.disabled=true;
  updatePayout();
}

function reveal(i,t){
  if(!inRound||revealed.has(i)) return;
  revealed.add(i); t.classList.add('clicked');

  if(mines.has(i)){
    const b=document.createElement('div'); b.className='bomb'; t.appendChild(b);
    Array.from(grid.children).forEach((tile,j)=>{
      if(!revealed.has(j)){
        tile.classList.add('revealed','black-bg');
        const e=document.createElement('div');
        e.className=mines.has(j)?'bomb':'gem';
        e.style.transform='scale(var(--lost-scale))';
        e.style.opacity='0.3';
        tile.appendChild(e);
      }
    });
    endRound(false);
  } else {
    const g=document.createElement('div'); g.className='gem'; t.appendChild(g);
    safe++; updatePayout();
    if(safe >= total - minesCount) { cashout(); }
  }
}

function cashout(){
  if(!inRound) return;
  const multiplier=fair(safe);
  const payout=bet*multiplier;
  bal+=payout;
  balanceTop.textContent=bal.toFixed(2)+' €';
  endRound(true);
}

function randomTile(){
  if(!inRound) return;
  const available=[...Array(total).keys()].filter(i=>!revealed.has(i));
  if(available.length===0) return;
  const i=available[Math.floor(Math.random()*available.length)];
  const t=grid.children[i];
  reveal(i,t);
}

function endRound(won){
  inRound=false;
  startBtn.style.display='inline-block'; 
  cashBtn.style.display='none';
  randomBtn.classList.remove('green');
  randomBtn.classList.add('disabled');
  minesInp.disabled=false; betInp.disabled=false; gridInp.disabled=false;
  cashBtn.textContent='Cashout';
}

startBtn.onclick=startRound;
cashBtn.onclick=cashout;
randomBtn.onclick=randomTile;

createGrid(gridSize);
</script>

</body>
</html>
